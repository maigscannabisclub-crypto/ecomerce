generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model SalesReport {
  id          String   @id @default(uuid())
  period      String   // DAILY, WEEKLY, MONTHLY, YEARLY
  periodStart DateTime
  periodEnd   DateTime
  totalOrders Int
  totalRevenue Decimal @db.Decimal(12, 2)
  totalTax    Decimal @db.Decimal(12, 2)
  totalShipping Decimal @db.Decimal(12, 2)
  averageOrderValue Decimal @db.Decimal(10, 2)
  data        Json     // Detalles adicionales
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([period])
  @@index([periodStart])
  @@unique([period, periodStart])
}

model ProductSales {
  id          String   @id @default(uuid())
  productId   String
  productName String
  productSku  String
  period      String
  periodStart DateTime
  quantity    Int
  revenue     Decimal @db.Decimal(12, 2)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([productId])
  @@index([period])
  @@index([periodStart])
  @@unique([productId, period, periodStart])
}

model ProcessedEvent {
  id        String   @id @default(uuid())
  eventId   String   @unique
  eventType String
  processedAt DateTime @default(now())
  
  @@index([eventId])
}

model DailyMetric {
  id          String   @id @default(uuid())
  date        DateTime @unique
  totalOrders Int      @default(0)
  totalRevenue Decimal @default(0) @db.Decimal(12, 2)
  newCustomers Int    @default(0)
  topProductId String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
