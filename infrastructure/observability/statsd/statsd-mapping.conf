# StatsD to Prometheus Mapping Configuration
# Maps StatsD metrics to Prometheus format

# ==========================================
# HTTP Request Metrics
# ==========================================
- match: "http.request.*.*.*"
  name: "http_requests_total"
  labels:
    service: "$1"
    method: "$2"
    status: "$3"
  match_metric_type: counter

- match: "http.request.duration.*.*"
  name: "http_request_duration_seconds"
  labels:
    service: "$1"
    endpoint: "$2"
  match_metric_type: timer
  observer_type: histogram
  buckets: [0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1, 2.5, 5, 10]

- match: "http.request.errors.*.*"
  name: "http_request_errors_total"
  labels:
    service: "$1"
    error_type: "$2"
  match_metric_type: counter

# ==========================================
# Database Metrics
# ==========================================
- match: "db.query.duration.*.*"
  name: "database_query_duration_seconds"
  labels:
    service: "$1"
    operation: "$2"
  match_metric_type: timer
  observer_type: histogram
  buckets: [0.001, 0.005, 0.01, 0.025, 0.05, 0.1, 0.25, 0.5, 1]

- match: "db.connections.*.*"
  name: "database_connections"
  labels:
    service: "$1"
    state: "$2"
  match_metric_type: gauge

- match: "db.errors.*.*"
  name: "database_errors_total"
  labels:
    service: "$1"
    error_type: "$2"
  match_metric_type: counter

# ==========================================
# Cache Metrics
# ==========================================
- match: "cache.hit.*"
  name: "cache_hits_total"
  labels:
    cache_name: "$1"
  match_metric_type: counter

- match: "cache.miss.*"
  name: "cache_misses_total"
  labels:
    cache_name: "$1"
  match_metric_type: counter

- match: "cache.size.*"
  name: "cache_size"
  labels:
    cache_name: "$1"
  match_metric_type: gauge

- match: "cache.eviction.*"
  name: "cache_evictions_total"
  labels:
    cache_name: "$1"
  match_metric_type: counter

# ==========================================
# Queue/Message Metrics
# ==========================================
- match: "queue.size.*"
  name: "message_queue_size"
  labels:
    queue: "$1"
  match_metric_type: gauge

- match: "queue.messages.*.*"
  name: "queue_messages_total"
  labels:
    queue: "$1"
    action: "$2"
  match_metric_type: counter

- match: "queue.processing.*"
  name: "queue_processing_seconds"
  labels:
    queue: "$1"
  match_metric_type: timer
  observer_type: histogram

# ==========================================
# Business Metrics
# ==========================================
- match: "orders.*"
  name: "orders_total"
  labels:
    status: "$1"
  match_metric_type: counter

- match: "order.value.*"
  name: "order_value_total"
  labels:
    currency: "$1"
  match_metric_type: counter

- match: "payments.*.*"
  name: "payments_total"
  labels:
    status: "$1"
    method: "$2"
  match_metric_type: counter

- match: "users.*"
  name: "users_total"
  labels:
    action: "$1"
  match_metric_type: counter

- match: "cart.*"
  name: "cart_actions_total"
  labels:
    action: "$1"
  match_metric_type: counter

# ==========================================
# JVM/Application Metrics
# ==========================================
- match: "jvm.memory.used.*"
  name: "jvm_memory_used_bytes"
  labels:
    area: "$1"
  match_metric_type: gauge

- match: "jvm.memory.max.*"
  name: "jvm_memory_max_bytes"
  labels:
    area: "$1"
  match_metric_type: gauge

- match: "jvm.gc.*.*"
  name: "jvm_gc_seconds"
  labels:
    collector: "$1"
    phase: "$2"
  match_metric_type: timer
  observer_type: summary

- match: "jvm.threads.*"
  name: "jvm_threads"
  labels:
    state: "$1"
  match_metric_type: gauge

# ==========================================
# Custom Application Metrics
# ==========================================
- match: "app.active.connections.*"
  name: "active_connections"
  labels:
    service: "$1"
  match_metric_type: gauge

- match: "app.sessions.*"
  name: "active_sessions"
  labels:
    service: "$1"
  match_metric_type: gauge

- match: "app.custom.*.*"
  name: "app_custom_metric"
  labels:
    service: "$1"
    metric_name: "$2"
  match_metric_type: gauge

# ==========================================
# Default catch-all mappings
# ==========================================
- match: "*.count"
  name: "${1}_total"
  match_metric_type: counter

- match: "*.gauge"
  name: "${1}"
  match_metric_type: gauge

- match: "*.timer"
  name: "${1}_seconds"
  match_metric_type: timer
  observer_type: histogram
