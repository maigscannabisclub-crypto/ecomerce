generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Cart {
  id        String     @id @default(uuid())
  userId    String     @unique
  items     CartItem[]
  total     Decimal    @default(0) @db.Decimal(10, 2)
  status    CartStatus @default(ACTIVE)
  expiresAt DateTime
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  
  @@index([userId])
  @@index([status])
  @@index([expiresAt])
  @@map("carts")
}

model CartItem {
  id          String   @id @default(uuid())
  cartId      String
  cart        Cart     @relation(fields: [cartId], references: [id], onDelete: Cascade)
  productId   String
  productName String
  productSku  String
  quantity    Int
  unitPrice   Decimal  @db.Decimal(10, 2)
  subtotal    Decimal  @db.Decimal(10, 2)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([cartId])
  @@index([productId])
  @@unique([cartId, productId])
  @@map("cart_items")
}

enum CartStatus {
  ACTIVE
  CONVERTED
  ABANDONED
  EXPIRED
  
  @@map("cart_status")
}
